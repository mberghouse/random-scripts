V_0=.5;
a=.08;
x(1)=0;
y1(1)=a/8;
t(1)=-20;
n=1000
%dt=zeros(n,1);
y=zeros(n,1);
dt=a/(V_0*100);
t = -100:dt:100;

%dx=V_0*a^2*(y1(i)^2-(x(i)+V_0*t(i)^2))/(y1(i)^2+(x(i)+V_0*t(i))^2)^2
%dy=-V_0*a^2*2*y1(i)*(x(i)+V_0*t(i))/(y1(i)^2+(x(i)+V_0*t(i))^2)^2
%RK4 for y1
for i=1:1000
    %dx=V_0*a^2*(y1(i)^2-(x(i)+V_0*t(i)^2))/(y1(i)^2+(x(i)+V_0*t(i))^2)^2
    %dy=-V_0*a^2*2*y1(i)*(x(i)+V_0*t(i))/(y1(i)^2+(x(i)+V_0*t(i))^2)^2% calculation loop
    k_1 = -V_0*a^2*2*y1(i)*(x(i)+V_0*t(i))/(y1(i)^2+(x(i)+V_0*t(i))^2)^2;
    k_2 = -V_0*a^2*2*(y1(i)+(dt*k_1/2))*(x(i)+.5*dt+V_0*t(i))/((y1(i)+dt*k_1/2)^2+(x(i)+.5*dt+V_0*t(i))^2)^2;
    k_3 = -V_0*a^2*2*(y1(i)+(dt*k_2/2))*(x(i)+.5*dt+V_0*t(i))/((y1(i)+dt*k_2/2)^2+(x(i)+.5*dt+V_0*t(i))^2)^2; 
    k_4 = -V_0*a^2*2*(y1(i)+(dt*k_3))*(x(i)+dt+V_0*t(i))/((y1(i)+dt*k_3)^2+(x(i)+dt+V_0*t(i))^2)^2;

    y1(i+1) = y1(i) + (1/6)*(k_1+2*k_2+2*k_3+k_4)*dt;
    
    k_1_2 = V_0*a^2*(y1(i)^2-(x(i)+V_0*t(i))^2/(y1(i)^2+(x(i)+V_0*t(i))^2)^2);
    k_2_2 = V_0*a^2*((y1(i)+(dt*k_1/2))^2-(x(i)+.5*dt+V_0*t(i))^2/((y1(i)+dt*k_1/2)^2+(x(i)+.5*dt+V_0*t(i))^2)^2);
    k_3_2 = V_0*a^2*((y1(i)+(dt*k_2/2))^2-(x(i)+.5*dt+V_0*t(i))^2/((y1(i)+dt*k_2/2)^2+(x(i)+.5*dt+V_0*t(i))^2)^2); 
    k_4_2 = V_0*a^2*((y1(i)+(dt*k_3))^2-(x(i)+dt+V_0*t(i))^2/((y1(i)+dt*k_3)^2+(x(i)+dt+V_0*t(i))^2)^2);

    x(i+1) = x(i) + (1/6)*(k_1_2+2*k_2_2+2*k_3_2+k_4_2)*dt;
    %x1(% main equation
end































































